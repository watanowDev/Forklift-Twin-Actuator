cmake_minimum_required(VERSION 3.15)
project(PatliteLED VERSION 1.0.0 LANGUAGES CXX)

# C++17 표준 사용
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# ============================================
# 소스 파일 및 헤더 파일 설정
# ============================================
set(HEADER_FILES
    include/EventAggregator.h
    include/LEDModels.h
    include/StatusLED/PatliteLEDBuzzer.h
)

set(SOURCE_FILES
    src/PatliteLEDBuzzer.cpp
)

# ============================================
# 라이브러리 생성 (재사용 가능)
# ============================================
add_library(PatliteLEDLib STATIC
    ${HEADER_FILES}
    ${SOURCE_FILES}
)

# 인클루드 디렉토리 설정
target_include_directories(PatliteLEDLib PUBLIC
    ${CMAKE_CURRENT_SOURCE_DIR}/include
)

# ============================================
# 실행 파일 생성 (테스트용)
# ============================================
add_executable(PatliteLEDTest
    src/main.cpp
)

# 라이브러리 링크
target_link_libraries(PatliteLEDTest PRIVATE
    PatliteLEDLib
)

# ============================================
# NeUsbController.dll 링크 설정
# DLL 파일이 있는 경로를 지정해야 합니다
# ============================================
# 방법 1: DLL을 프로젝트 폴더에 복사하여 사용
# 방법 2: 아래처럼 경로를 직접 지정

# NeUsbController.dll의 import library(.lib) 파일 경로
# 예시: set(NEUSBCONTROLLER_LIB_PATH "C:/Path/To/NeUsbController.lib")

# 만약 .lib 파일이 있다면:
# target_link_libraries(PatliteLEDLib PRIVATE ${NEUSBCONTROLLER_LIB_PATH})

# .lib 파일 없이 런타임에만 DLL을 로드하려면:
# LoadLibrary를 사용하여 동적 로딩 (별도 구현 필요)

# ============================================
# 설치 설정 (선택사항)
# ============================================
install(TARGETS PatliteLEDLib PatliteLEDTest
    LIBRARY DESTINATION lib
    ARCHIVE DESTINATION lib
    RUNTIME DESTINATION bin
)

install(DIRECTORY include/
    DESTINATION include
    FILES_MATCHING PATTERN "*.h"
)

# ============================================
# 빌드 메시지
# ============================================
message(STATUS "========================================")
message(STATUS "  Patlite LED/Buzzer C++ 프로젝트")
message(STATUS "========================================")
message(STATUS "C++ 표준: C++${CMAKE_CXX_STANDARD}")
message(STATUS "빌드 타입: ${CMAKE_BUILD_TYPE}")
message(STATUS "========================================")
